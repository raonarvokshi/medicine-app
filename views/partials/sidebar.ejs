<nav id="sidebarMenu" class="col-lg-2 d-lg-block sidebar collapse shadow">
        <div class="position-sticky pt-3">
          <ul class="nav flex-column">
            <li class="nav-item text-center">
              <a class="nav-link dashboard-sidebar__link" href="/dashboard">
                <i class="fa-solid fa-user"></i> <%= user.username %>
              </a>
            </li>
            <hr>
            
            <li class="nav-item mb-3">
                <a class="nav-link sidebar-link d-flex align-items-center" data-bs-toggle="collapse" href="#doctorsMenu" role="button"
                  aria-expanded="<%= (activeMenu === 'shenimet') ? 'true' : 'false' %>">
                  <i class="fas fa-pen"></i>&nbsp;
                  <span class="flex-grow-1">SHENIMET</span>
                  <i class="fa-solid fa-chevron-down arrow ms-auto"></i>
                </a>
                <div class="collapse menu <%= (activeMenu === 'shenimet') ? 'show' : '' %>" id="doctorsMenu">
                    <ul class="btn-toggle-nav list-unstyled fw-normal small">
                        <li class="ps-3 pb-1 nav-link__wrapper <%= doctorsPage ? 'active' : '' %>">
                            <a href="/view/doctors" class="nav-link">
                                <i class="fas fa-user-md"></i>&nbsp; Doktorat
                            </a>
                        </li>

                        <li class="ps-3 pb-1 nav-link__wrapper <%= patientsPage ? 'active' : '' %>">
                            <a href="/view/patients" class="nav-link">
                                <i class="fas fa-users"></i>&nbsp; Pacientat
                            </a>
                        </li>

                        <li class="ps-3 nav-link__wrapper <%= refPage ? 'active' : '' %>">
                            <a href="/view/refs" class="nav-link">
                                <i class="fas fa-user-md"></i>&nbsp; Referuesit
                            </a>
                        </li>

                        <li class="ps-3 nav-link__wrapper <%= locationPage ? 'active' : '' %>">
                            <a href="/view/location" class="nav-link">
                              <i class="fa-solid fa-location-dot"></i>&nbsp; Njesit organizative
                            </a>
                        </li>

                        <li class="ps-3 pb-1 nav-link__wrapper <%= appointmentsPage ? 'active' : '' %>">
                          <a href="/view/appointments" class="nav-link">
                            <i class="fas fa-calendar-check"></i>&nbsp; Terminet
                          </a>
                        </li>

                    </ul>
                </div>
            </li>

            <li class="nav-item mb-3">
              <a class="nav-link sidebar-link d-flex align-items-center" data-bs-toggle="collapse" href="#clinicMenu" role="button">
                <i class="fas fa-hospital"></i>&nbsp;
                <span class="flex-grow-1">KLINIKA</span>
                <i class="fa-solid fa-chevron-down arrow ms-auto"></i>
              </a>
              <div class="collapse menu" id="clinicMenu">
                <ul class="btn-toggle-nav list-unstyled fw-normal small">
                  <li  class="ps-3 pb-1">
                    <a href="/clinic/departments" class="nav-link">
                      <i class="fas fa-building"></i>&nbsp; Departamentet
                    </a>
                  </li>
                  <li  class="ps-3">
                    <a href="/clinic/services" class="nav-link">
                      <i class="fas fa-stethoscope"></i>&nbsp; Sherbimet
                    </a>
                  </li>
                </ul>
              </div>
            </li>

            <li class="nav-item mb-3">
              <a class="nav-link sidebar-link d-flex align-items-center" data-bs-toggle="collapse" href="#labMenu" role="button">
                <i class="fas fa-vial"></i>&nbsp;
                <span class="flex-grow-1">LABORATORI</span>
                <i class="fa-solid fa-chevron-down arrow ms-auto"></i>
              </a>
              <div class="collapse menu" id="labMenu">
                <ul class="btn-toggle-nav list-unstyled fw-normal small">
                  <li class="ps-3 pb-1">
                    <a href="/lab/tests" class="nav-link">
                      <i class="fas fa-microscope"></i>&nbsp; Testet
                    </a>
                  </li>
                  <li class="ps-3">
                    <a href="/lab/results" class="nav-link">
                      <i class="fas fa-file-medical"></i>&nbsp; Rezultatet
                    </a>
                  </li>
                </ul>
              </div>
            </li>

            <li class="nav-item mb-3">
              <a class="nav-link sidebar-link d-flex align-items-center" data-bs-toggle="collapse" href="#bioMenu" role="button">
                <i class="fas fa-dna"></i>&nbsp;
                <span class="flex-grow-1">BIOKIMIA</span>
                <i class="fa-solid fa-chevron-down arrow ms-auto"></i>
              </a>
              <div class="collapse menu" id="bioMenu">
                <ul class="btn-toggle-nav list-unstyled fw-normal small">
                  <li class="ps-3 pb-1">
                    <a href="/biochem/parameters" class="nav-link">
                      <i class="fas fa-vials"></i>&nbsp; Parametrat biokimik
                    </a>
                  </li>
                  <li class="ps-3">
                    <a href="/biochem/history" class="nav-link">
                      <i class="fas fa-history"></i>&nbsp; Historia e analizave
                    </a>
                  </li>
                </ul>
              </div>
            </li>

            <li class="nav-item mb-3">
              <a class="nav-link sidebar-link d-flex align-items-center" data-bs-toggle="collapse" href="#adminMenu" role="button">
                <i class="fas fa-user-shield"></i>&nbsp;
                <span class="flex-grow-1">ADMINISTRATA</span>
                <i class="fa-solid fa-chevron-down arrow ms-auto"></i>
              </a>
              <div class="collapse menu" id="adminMenu">
                <ul class="btn-toggle-nav list-unstyled fw-normal small">
                  <li class="ps-3 pb-1">
                    <a href="/admin/users" class="nav-link">
                      <i class="fas fa-users-cog"></i>&nbsp; Perdoruesit
                    </a>
                  </li>
                  <li class="ps-3 pb-1">
                    <a href="/admin/roles" class="nav-link">
                      <i class="fas fa-user-tag"></i>&nbsp; Rolet
                    </a>
                  </li>
                  <li class="ps-3">
                    <a href="/admin/payments" class="nav-link">
                      <i class="fas fa-credit-card"></i>&nbsp; Pagesat
                    </a>
                  </li>
                </ul>
              </div>
            </li>


            <li class="nav-item mb-3">
                <a class="nav-link sidebar-link d-flex align-items-center" data-bs-toggle="collapse" href="#settingsMenu" role="button">
                    <i class="fa-solid fa-gear"></i>&nbsp;
                    <span class="flex-grow-1">CILESIMET</span>
                    <i class="fa-solid fa-chevron-down arrow ms-auto"></i>
                </a>
                <div class="collapse menu" id="settingsMenu">
                  <ul class="btn-toggle-nav list-unstyled fw-normal small">
                    <li class="ps-3 pb-1">
                      <a href="/profile" class="nav-link">
                        <i class="fa-solid fa-user"></i>&nbsp; Profil
                      </a>
                    </li>

                    <li class="ps-3 pb-1">
                      <a href="/profile/change-password" class="nav-link">
                        <i class="fa-solid fa-lock"></i>&nbsp; Ndrro fjalkalimin
                      </a>
                    </li>
                    
                    <li class="ps-3 pb-1">
                      <a href="/profile/delete-account" class="nav-link">
                        <i class="fa-solid fa-trash"></i>&nbsp; Fshij llogarin
                      </a>
                    </li>

                    <li class="ps-3">
                      <a href="/logout" class="nav-link">
                         <i class="fa-solid fa-arrow-right-from-bracket"></i> Dil
                      </a>
                    </li>
                  </ul>
                </div>
            </li>
          </ul>
        </div>
      </nav>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const allToggles = document.querySelectorAll('.sidebar-link[data-bs-toggle="collapse"]');

    allToggles.forEach(toggle => {
      toggle.addEventListener('click', function () {
        const targetId = this.getAttribute('href').replace('#', '');
        const targetMenu = document.getElementById(targetId);

        // Mbyll të gjitha menut përveç asaj që po hapet
        document.querySelectorAll('.collapse.menu').forEach(menu => {
          if (menu !== targetMenu) {
            new bootstrap.Collapse(menu, { toggle: false }).hide();
          }
        });
      });
    });
  });
</script>
